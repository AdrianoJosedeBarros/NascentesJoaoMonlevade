<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebGIS Jo√£o Monlevade - MG</title>
    
    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <!-- Font Awesome para √≠cones -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS personalizado -->
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <h1><i class="fas fa-map-marked-alt"></i> WebGIS Jo√£o Monlevade</h1>
            <div class="device-toggle">
                <button id="desktopMode" class="mode-btn active">
                    <i class="fas fa-desktop"></i> Desktop
                </button>
                <button id="mobileMode" class="mode-btn">
                    <i class="fas fa-mobile-alt"></i> Mobile
                </button>
            </div>
        </div>
    </header>

    <!-- Container principal -->
    <div class="main-container">
        <!-- Sidebar com controles -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h3><i class="fas fa-layers"></i> Controle de Camadas</h3>
                <button class="close-sidebar" id="closeSidebar">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="layer-controls">
                <div class="layer-group">
                    <h4><i class="fas fa-map"></i> Mapas Base</h4>
                    <div class="layer-item">
                        <input type="radio" name="basemap" id="streets" value="streets" checked>
                        <label for="streets">Ruas (OpenStreetMap)</label>
                    </div>
                    <div class="layer-item">
                        <input type="radio" name="basemap" id="satellite" value="satellite">
                        <label for="satellite">Sat√©lite (Esri)</label>
                    </div>
                    <div class="layer-item">
                        <input type="radio" name="basemap" id="terrain" value="terrain">
                        <label for="terrain">Terreno (OpenTopoMap)</label>
                    </div>
                </div>

                <div class="layer-group">
                    <h4><i class="fas fa-city"></i> Dados da Cidade</h4>
                    <div class="layer-item">
                        <input type="checkbox" id="bairros" checked>
                        <label for="bairros">Bairros</label>
                    </div>
                    <div class="layer-item">
                        <input type="checkbox" id="estruturas" checked>
                        <label for="estruturas">Estruturas Urbanas</label>
                    </div>
                    <div class="layer-item">
                        <input type="checkbox" id="monlevade" checked>
                        <label for="monlevade">Limites Municipais</label>
                    </div>
                    <div class="layer-item">
                        <input type="checkbox" id="ruas">
                        <label for="ruas">Ruas</label>
                    </div>
                    <div class="layer-item">
                        <input type="checkbox" id="nascentes">
                        <label for="nascentes">Nascentes</label>
                    </div>
                </div>

                <div class="layer-group">
                    <h4><i class="fas fa-tools"></i> Ferramentas</h4>
                    <button id="fullscreenBtn" class="tool-btn">
                        <i class="fas fa-expand"></i> Tela Cheia
                    </button>
                    <button id="measureBtn" class="tool-btn">
                        <i class="fas fa-ruler"></i> Medir Dist√¢ncia
                    </button>
                    <button id="infoBtn" class="tool-btn">
                        <i class="fas fa-info-circle"></i> Informa√ß√µes
                    </button>
                </div>

                <div class="layer-group">
                    <h4><i class="fas fa-search"></i> An√°lise Espacial</h4>
                    <div class="analysis-controls">
                        <label for="bufferRadius">Raio do Buffer:</label>
                        <select id="bufferRadius" class="analysis-select">
                            <option value="100">100 metros</option>
                            <option value="250" selected>250 metros</option>
                            <option value="500">500 metros</option>
                            <option value="1000">1 km</option>
                        </select>
                        
                        <button id="startAnalysisBtn" class="analysis-btn">
                            <i class="fas fa-play"></i> Iniciar An√°lise
                        </button>
                        
                        <button id="clearAnalysisBtn" class="analysis-btn secondary">
                            <i class="fas fa-times"></i> Limpar
                        </button>
                        
                        <button id="statsBtn" class="analysis-btn secondary">
                            <i class="fas fa-chart-bar"></i> Resumo Estat√≠stico
                        </button>
                    </div>
                    
                    <div class="analysis-status" id="analysisStatus">
                        <p><i class="fas fa-info-circle"></i> Clique em uma nascente para analisar</p>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Bot√£o para abrir sidebar no mobile -->
        <button class="sidebar-toggle" id="sidebarToggle">
            <i class="fas fa-bars"></i>
        </button>

        <!-- Bot√£o flutuante de controle de camadas -->
        <div class="layers-toggle-container">
            <div class="layers-toggle-tooltip">
                <i class="fas fa-info-circle"></i>
                <span>Controle de Camadas</span>
            </div>
            <button class="layers-toggle" id="layersToggle" title="Abrir Controle de Camadas">
                <i class="fas fa-layers"></i>
                <span class="layers-text">Camadas</span>
            </button>
        </div>

        <!-- Container do mapa -->
        <main class="map-container">
            <div id="map"></div>
            
            <!-- Popup inicial -->
            <div id="welcomePopup" class="welcome-popup">
                <div class="popup-content">
                    <div class="popup-header">
                        <h3><i class="fas fa-map-marker-alt"></i> Jo√£o Monlevade - MG</h3>
                        <button id="closeWelcome" class="close-popup-btn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <p class="popup-subtitle">WebGIS Interativo - Vale do A√ßo</p>
                    <div class="city-info-compact">
                        <div class="info-row">
                            <span class="info-label"><i class="fas fa-users"></i> Popula√ß√£o:</span>
                            <span class="info-value">80.187 hab (2022)</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label"><i class="fas fa-map"></i> √Årea:</span>
                            <span class="info-value">~99 km¬≤</span>
                        </div>
                        <div class="info-row">
                            <span class="info-label"><i class="fas fa-tint"></i> Nascentes:</span>
                            <span class="info-value">37 pontos</span>
                        </div>
                    </div>
                    <div class="popup-actions">
                        <button id="startExploring" class="explore-btn">
                            <i class="fas fa-play"></i> Explorar
                        </button>
                        <button id="showHistoryQR" class="history-btn">
                            <i class="fas fa-qrcode"></i> Hist√≥ria da Cidade
                        </button>
                    </div>
                </div>
            </div>

            <!-- Barra de status -->
            <div class="status-bar">
                <span id="coordinates">Lat: 0, Lng: 0</span>
                <span id="zoom">Zoom: 10</span>
                <span id="scale">Escala: 1:1000</span>
            </div>

            <!-- Legenda -->
            <div class="legend" id="legend">
                <h4><i class="fas fa-list"></i> Legenda</h4>
                <div class="legend-item">
                    <span class="legend-color" style="background: #3498db;"></span>
                    <span>Bairros</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #e74c3c;"></span>
                    <span>Estruturas Urbanas</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #27ae60;"></span>
                    <span>Limites Municipais</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #f39c12;"></span>
                    <span>Ruas</span>
                </div>
                <div class="legend-item">
                    <span class="legend-color" style="background: #9b59b6;"></span>
                    <span>Nascentes</span>
                </div>
                <div class="legend-item" id="bufferLegend" style="display: none;">
                    <span class="legend-color" style="background: rgba(255, 193, 7, 0.6); border: 2px solid #ffc107;"></span>
                    <span>√Årea de Influ√™ncia</span>
                </div>
            </div>

            <!-- Modal da Hist√≥ria da Cidade -->
            <div class="history-modal" id="historyModal">
                <div class="modal-content">
                    <div class="modal-header">
                        <h3><i class="fas fa-landmark"></i> Hist√≥ria de Jo√£o Monlevade</h3>
                        <button class="close-modal" id="closeHistoryModal">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="modal-body">
                        <div class="history-content">
                            <div class="history-text">
                                <h4>üèõÔ∏è Funda√ß√£o e Desenvolvimento</h4>
                                <p>Jo√£o Monlevade foi fundada em 29 de abril de 1964, mas sua hist√≥ria remonta ao s√©culo XVIII. A cidade deve seu desenvolvimento √† <strong>Companhia Sider√∫rgica Belgo-Mineira</strong>, instalada em 1937.</p>
                                
                                <h4>üè≠ A Cidade do A√ßo</h4>
                                <p>Conhecida como a "Cidade do A√ßo", Jo√£o Monlevade √© um dos principais centros sider√∫rgicos do Brasil, com produ√ß√£o de a√ßos especiais e produtos de alta qualidade.</p>
                                
                                <h4>üåä Recursos H√≠dricos</h4>
                                <p>A cidade √© privilegiada com abundantes recursos h√≠dricos, incluindo <strong>37 nascentes mapeadas</strong>, Rio Piracicaba e diversos c√≥rregos.</p>
                                
                                <h4>üìä Dados Atuais</h4>
                                <p><strong>Popula√ß√£o:</strong> 80.187 habitantes (2022)<br>
                                <strong>√Årea:</strong> ~99 km¬≤<br>
                                <strong>Regi√£o:</strong> Vale do A√ßo - MG</p>
                            </div>
                            <div class="qr-section">
                                <h4><i class="fas fa-qrcode"></i> QR Code da Hist√≥ria</h4>
                                <div class="qr-container" id="qrContainer">
                                    <div class="qr-loading">
                                        <i class="fas fa-spinner fa-spin"></i>
                                        <p>Gerando QR Code...</p>
                                    </div>
                                </div>
                                <p class="qr-info">Escaneie para acessar a hist√≥ria completa da cidade</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Painel de Resultados da An√°lise -->
            <div class="analysis-results" id="analysisResults">
                <div class="results-header">
                    <h4><i class="fas fa-chart-bar"></i> Resultados da An√°lise</h4>
                    <button class="close-results" id="closeResults">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="results-content" id="resultsContent">
                    <p class="no-results">Nenhuma an√°lise realizada</p>
                </div>
            </div>
        </main>
    </div>

    <!-- Scripts -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
</body>
</html> 